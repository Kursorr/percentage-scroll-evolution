<template>
  <div>
    <PercentageBar 
      emptyBar="height: 10px; background-color: red;"
      progressBar="background-color: purple;"
    />
    <article v-on:scroll="onScroll">
      <h1>Your super title here !</h1>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quibusdam exercitationem magnam repudiandae amet veritatis dignissimos cupiditate eveniet maiores, ipsam blanditiis tempore libero molestias necessitatibus. Repellat deserunt corrupti maxime asperiores neque?
        Saepe assumenda quasi fugit magnam non, tempore blanditiis eos rem facere nostrum voluptate dolore harum? Iure ea architecto dolor pariatur nostrum, quisquam, facere voluptatibus fuga, sint vero numquam corporis quae?
        Fuga sapiente quasi ex illo enim iusto, veniam, pariatur distinctio et reprehenderit vel dolorem aperiam obcaecati commodi dignissimos beatae voluptatem optio voluptatibus esse sint, ipsum error. Sint vero accusantium dicta?
        Nemo corporis facere nisi necessitatibus aliquam dignissimos nulla obcaecati consequuntur. Provident veniam a dolore ea? Tempore pariatur nulla fuga nemo facere eveniet ipsam sequi, necessitatibus tenetur sit accusamus dignissimos quod!
        Maxime cupiditate soluta reprehenderit similique cum a ducimus id cumque distinctio dolorem, itaque pariatur, magni, veniam consectetur doloribus eum sapiente iure enim animi est numquam delectus excepturi? Ullam, cumque deleniti.
        Nam omnis, delectus nostrum doloribus possimus enim. Laudantium inventore asperiores nobis rem perspiciatis saepe ratione earum accusantium quam amet soluta eos numquam, quasi aut corporis enim tenetur temporibus ab dolorum.
        Temporibus consequatur, exercitationem voluptate facilis placeat aut libero nobis possimus nulla facere delectus quia labore sequi odit quo dicta tenetur. Corrupti dolores illum molestias blanditiis rem deleniti et numquam sunt.
        Quas, corrupti voluptatibus consequuntur fugit ipsam aperiam commodi minima aliquam laborum optio nostrum architecto mollitia amet non minus dolorum hic sunt. Officiis optio laudantium rerum! Repellendus totam asperiores nesciunt culpa?
        Officia, laboriosam quisquam. Aspernatur, quo? Voluptatem reiciendis provident quaerat placeat! Qui, aliquid! Aperiam officia perspiciatis obcaecati porro alias quidem asperiores rerum culpa tenetur. Excepturi neque voluptatum aliquam corporis ab dolore?
        Nesciunt accusantium, expedita suscipit a impedit in nemo officia quia exercitationem quo labore alias magnam qui inventore pariatur officiis quasi. Fugiat mollitia laudantium asperiores illum ut suscipit debitis maxime vitae?
        Dignissimos error facere quia, similique, eaque aliquam libero, eos possimus in repudiandae iste quidem et sapiente. Consequatur sapiente pariatur ratione eum, quidem nobis hic voluptatibus quae placeat, officiis dolorem vel.
        Nemo dolorem, minima magni obcaecati dolor eius illo. Reiciendis soluta cumque, maxime consequatur dolorem nam quisquam quo numquam magnam animi rerum fugiat aliquid voluptate? Incidunt doloremque ab earum dolore nesciunt?
        Recusandae velit laborum nostrum perferendis voluptatibus, optio omnis quidem doloribus provident voluptatum architecto a consequuntur, ex ad distinctio libero cum cupiditate id odio. Itaque, impedit quam similique praesentium temporibus magni!
        Hic illum, ex maxime repellat dicta dignissimos libero deserunt nisi distinctio inventore, excepturi odio voluptas, quod saepe alias suscipit voluptatem a quam obcaecati amet vitae vel odit. Qui, odit exercitationem?
        Rerum enim tenetur necessitatibus sapiente! Dolores, nam, laudantium ipsum quos blanditiis enim magnam laborum ex veniam, numquam sunt natus impedit voluptate eos? Deserunt cumque officiis perspiciatis nostrum reprehenderit totam eum!
        Lorem ipsum dolor sit amet consectetur adipisicing elit. A alias quas, vero rerum veritatis saepe laborum quibusdam dolore officiis nihil magnam possimus nobis repudiandae aspernatur tempora nisi! Voluptate, mollitia ab!
        Numquam, commodi! Mollitia rerum repellat libero? Doloremque odio commodi velit facilis sed porro reprehenderit hic beatae rem dolores, accusamus repellendus accusantium fuga neque saepe culpa pariatur at quisquam nulla soluta.
        Quisquam, est excepturi. Quaerat magni architecto beatae. Autem at voluptatum, ducimus ipsum, nesciunt libero exercitationem debitis itaque numquam omnis vitae quaerat, enim a non quibusdam excepturi neque aspernatur facere dignissimos.
        Recusandae cum voluptatibus harum quibusdam alias repudiandae natus rem voluptates quaerat. Tempore at vero eos, minus dolor voluptate nobis impedit dolorum laborum, sed, debitis reiciendis expedita perspiciatis vel ea facere?
        Et impedit explicabo itaque! Sit facilis consequuntur cum magni deserunt, laborum blanditiis voluptas sunt unde asperiores modi nostrum iure dicta exercitationem mollitia nisi ipsa aspernatur? Vel in exercitationem quis quod?
        Quod neque sequi obcaecati, aspernatur magnam rerum natus doloribus similique minus officia ipsum, blanditiis dolorum nemo reprehenderit quam fugiat! Aspernatur ipsum voluptatibus minus rerum esse non autem libero nesciunt error.
        Facere aut animi expedita repudiandae repellat architecto consequatur. Amet sint, consequatur facilis ea porro harum inventore aliquid sapiente similique illum id esse quod provident, voluptates eligendi natus architecto minus. Expedita!
        Neque cumque rerum culpa corrupti sapiente id dignissimos facere eos quibusdam ullam, velit, odio molestias exercitationem, debitis deserunt non possimus magni dicta provident dolorum reiciendis iure esse fugiat. Tempora, fuga?
        Rerum, eum, earum qui doloribus delectus excepturi hic molestias asperiores voluptas voluptates cupiditate possimus! Rem saepe voluptatum sed, aliquam amet, velit quae similique totam molestias dolores sequi vel recusandae doloribus?
        Amet repellendus natus dignissimos praesentium est minus dolores, odio consequatur rerum harum eveniet labore ipsum itaque voluptate at? Laborum numquam tempore facere repellat excepturi assumenda? Mollitia corrupti sed reiciendis ipsum.
        Ex necessitatibus praesentium, cum ipsum quae quis magni? Quia quos exercitationem animi ipsam excepturi libero fuga doloremque. Perspiciatis, saepe, voluptas molestias fuga sapiente minus soluta quaerat in sequi delectus magni.
        Iste, sit? Aliquid, excepturi, facilis quaerat placeat inventore repellat officia, cum labore maxime id laboriosam deleniti dolorum eius modi! Tempora repellendus quos est et atque a ipsa facere fuga asperiores.
        Eos, laborum tempora voluptatem illum laudantium vel nobis molestiae iste dolorum nisi officia quas mollitia neque repellat ea esse dolore officiis quaerat, beatae possimus animi ratione odit enim unde! Laudantium!
        Placeat adipisci odit excepturi ipsa corporis, porro reiciendis dolore veniam quam eius consequuntur consequatur sit numquam ratione quibusdam reprehenderit doloribus harum deleniti, quod nemo aperiam pariatur perferendis, asperiores praesentium! Unde?
        Consequuntur ullam porro tempora quibusdam dolor quidem itaque harum iure nemo suscipit vitae sequi deleniti, delectus sapiente perspiciatis in placeat a! Eaque consequuntur esse recusandae aliquid ullam nam quam exercitationem?
        Lorem ipsum, dolor sit amet consectetur adipisicing elit. Illo consequatur molestiae quae quos, id in illum libero! Ipsum nesciunt voluptates tempore, iusto cumque hic, perferendis quam et corrupti ipsam consequatur.
        Quas, eos officiis praesentium sed impedit dolorem ratione id autem fuga harum, ducimus doloribus aut, eum eius voluptatum! Aut maiores soluta incidunt laboriosam voluptates ab dicta corporis porro debitis officiis.
        Praesentium nemo, facilis itaque neque nesciunt consequatur optio beatae accusantium, reprehenderit hic eveniet accusamus magni, eaque natus sit aspernatur blanditiis dolor voluptatibus earum. Numquam, doloremque. Architecto nihil ex deserunt tenetur?
        Et quaerat placeat optio id quisquam fugiat sequi rerum quasi quos sed nihil deleniti ea soluta earum ipsam nam repellendus repellat doloribus, nesciunt delectus a enim adipisci blanditiis. Nemo, similique!
        Deserunt delectus vel ad hic, reprehenderit beatae explicabo quas quidem vero alias corrupti quae tenetur quia cum ex sint ducimus saepe libero qui veniam porro adipisci eos? Iste, praesentium fugiat.
        Sit corporis ex beatae, eos aliquid, labore deleniti, soluta nesciunt non alias veniam nostrum laboriosam cupiditate possimus minus quisquam adipisci esse? Dicta ea, mollitia doloribus illum quo doloremque explicabo ut!
        Voluptas, corporis consequuntur. Ratione fuga earum suscipit perspiciatis non eaque dolore architecto quisquam, eius culpa ut nam consequatur exercitationem a temporibus voluptate similique, totam provident illo nisi omnis aut sint.
        Iure ipsa enim id nam temporibus, consequuntur animi libero nobis provident quibusdam, nulla saepe illum facilis quae mollitia, dolorem totam beatae repellendus quo labore deleniti doloribus? Doloribus asperiores dolor saepe.
        Similique facere, neque cumque assumenda nihil enim vero corporis distinctio quaerat eveniet minus aspernatur consequatur dolorem nobis eius maiores fugiat dicta provident facilis quos dolore ex laborum? Omnis, voluptatum incidunt.
        Doloribus sunt vitae neque rerum corporis facilis quasi consequuntur aliquam nesciunt magni non, maiores assumenda doloremque sapiente incidunt eligendi id esse dolores ab quidem, temporibus veniam expedita iste. Possimus, in!
        Cum saepe odit minus possimus harum voluptatem tempore, asperiores cumque enim facilis nemo non odio quo aperiam qui sunt nulla! Eligendi ratione beatae labore quos, unde reprehenderit possimus. Doloribus, et?
        Natus quas laboriosam id velit? Illo dolores id quisquam quas adipisci, mollitia vel blanditiis corrupti porro at provident. Doloremque saepe mollitia placeat tempore officia quam sapiente laboriosam, rem nihil recusandae.
        Consectetur tempora laudantium sed id aliquid rerum perspiciatis voluptates odio, fuga adipisci magnam? Minus perspiciatis reiciendis deleniti velit maxime. Nulla reiciendis ad repellat quis voluptate consectetur molestias placeat excepturi eaque!
        Id tempora assumenda quidem aperiam a repudiandae ex, sequi nemo eius neque non saepe voluptatem fugit, sapiente maiores. Ipsam ut consectetur laborum velit repellat. Deserunt numquam cumque quo placeat voluptatem!
        Illo, doloremque a ratione dolore tenetur laboriosam maxime molestias sit expedita accusamus qui? Non quaerat veniam quis et in. Ut provident delectus vitae tenetur! Quae, repellendus reiciendis. Molestiae, voluptatibus fugiat.
      </p>
    </article>
  </div>
</template>

<script lang="ts">
  import { Component, Vue, Prop } from 'vue-property-decorator'
  import PercentageBar from './PercentageBar.vue'

  @Component({
    components: {
      PercentageBar
    }
  })
  export default class Post extends Vue {
    onScroll(event) {
      const position = event.target
      const scrollTop = position.scrollTop
      const scrollHeight = position.scrollHeight
      const clientHeight = position.clientHeight

      const percent = Math.floor((scrollTop / (scrollHeight - clientHeight)) * 100)

      const node = position.parentNode.firstChild
      for (let i = 0; i < node.children.length; i++) {
        const fillbar = node.children[i];
        if (fillbar.classList.contains('fill')) {
          fillbar.style.width = `${percent}%`;
        }
      }
    }
  }
</script>

<style lang="scss" scoped>
  article {
    width: 100%;
    max-width: 500px;
    height: 100%;
    max-height: 300px;
    overflow-y: scroll;
    margin: 0 auto;
    padding: 15px;
    background-color: #FFF;
    position: relative;
  }
</style>
